var defaultErrorAlert='Chức năng đang được bảo trì, vui lòng thử lại sau!';var itemPerPage=16;var Scrollable=true;var URLAJax="";var CatQuery={catId:"",pIndex:1,orderQuery:"",lang:""};var Render={renderItem:function(item,lang){var itemHtml="<div class='item'>";itemHtml+="<div class='i'>";itemHtml+="<a href='"+item.LinkItem+"' title='"+item.ItemName+"'><img src='"+item.LinkImage+"' alt='"+item.ItemName+"' title='"+item.ItemName+"' width='150' height='180'/></a>";itemHtml+="</div><div class='t'>";itemHtml+="<h4><a href='"+item.LinkItem+"' title='"+item.ItemName+"'>"+item.ItemName+"</a></h4>";if(lang=="vn"){if(item.OldPrice!="0"){itemHtml+="<span class='vn'><em class='oprice'>"+item.OldPrice+"</em><em>"+item.VNPrice+"</em></span>";}
else{itemHtml+="<span class='vn'>"+item.VNPrice+"</span>";}}
if(lang!="vn"){itemHtml+="<span class='vn'>"+item.VNPrice+"</span>";itemHtml+="<span class='en'>"+item.ENPrice+"</span>";}
itemHtml+="</div>";if(item.IsNew){itemHtml+="<span class='ibadge inew'></span>";}
if(item.IsPromotion){itemHtml+="<span class='ibadge isale'>Sale</span>";}
itemHtml+="</div>";$('#data_items div.items').append(itemHtml);},renderLink:function(number){var itemHtml="<a id='morelist' class='morelist' href='javascript:void(0);' onclick='StateResponse.LinkMore(this);'>Xem thêm, còn <em>";itemHtml+=number+"</em> <h5>sản phẩm hoa tươi</h5><strong class='icondown'></strong>";$('#data_items div.items').append(itemHtml);}};var StateResponse={LinkMore:function(ctrl){$(ctrl).remove();StateResponse.InitSendAjax();},InitSendAjax:function(){var LoadUrl=URLAJax;var jsonData=JSON.stringify(CatQuery);StateResponse.BeginSend(LoadUrl,jsonData,StateResponse.BeforeSendAjax,StateResponse.Success,StateResponse.ErrorAjax,true);},BeginSend:function(url,dat,befHandle,sucHandle,errHandle,asy){$.ajax({async:asy,url:url,data:dat,type:'POST',cache:false,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){befHandle();},success:function(e){sucHandle(e);},error:function(){errHandle();}});},BeforeSendAjax:function(){},ErrorAjax:function(){},Success:function(result){if(result==null){alert(defaultErrorAlert);location.reload();}
else{this.Scrollable=result.isLoad;CatQuery.pIndex=result.page;$.each(result.dataItem,function(i,item){Render.renderItem(item,CatQuery.lang);});if(this.Scrollable){Render.renderLink(result.total-CatQuery.pIndex*itemPerPage);}}}};(function(a){function onScroll(event){var winHeight=window.innerHeight?window.innerHeight:$(window).height();var bottomLoad=$('#data_items').offset().top+$('#data_items').height()+15;var closeToBottom=($(window).scrollTop()+winHeight>bottomLoad);if(closeToBottom&&this.Scrollable&&CatQuery.pIndex<2){this.Scrollable=false;this.StateResponse.InitSendAjax();}};$(window).bind('scroll',onScroll);})(jQuery);